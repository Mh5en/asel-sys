<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-hashes'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com data:; img-src 'self' data: https:; connect-src 'self';">
    <title>ุฅุฏุงุฑุฉ ุงูุฌุฑุฏ ูุงููุฑุชุฌุนุงุช - ูุธุงู ุฃุณูู</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Lateef:wght@400;700&family=Noto+Nastaliq+Urdu:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/inventory.css">
    <style>
        /* Tabs Styles */
        .tabs-container {
            margin-bottom: 30px;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        }
        
        .tabs {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            background: #f1f5f9;
            padding: 8px;
            border-radius: 12px;
        }
        
        .tab-btn {
            padding: 14px 28px;
            background: transparent;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            color: #64748b;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            font-family: 'IBM Plex Sans Arabic', sans-serif;
        }
        
        .tab-btn:hover {
            color: #8b4513;
            background: rgba(139, 69, 19, 0.08);
            transform: translateY(-2px);
        }
        
        .tab-btn.active {
            color: #ffffff;
            background: linear-gradient(135deg, #8b4513 0%, #5a2a12 100%);
            box-shadow: 0 4px 12px rgba(139, 69, 19, 0.3);
            transform: translateY(-2px);
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease-in;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <!-- Sidebar Navigation -->
    <nav class="sidebar">
        <div class="sidebar-header">
            <div class="logo">ุฃุณูู</div>
            <p class="system-name">ูุธุงู ุฅุฏุงุฑุฉ ุงูุดุฑูุฉ</p>
        </div>
        <ul class="sidebar-menu">
            <li><a href="index.html"><span class="icon">๐</span> ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ</a></li>
            <li><a href="products.html"><span class="icon">๐ฆ</span> ุงูููุชุฌุงุช</a></li>
            <li><a href="customers.html"><span class="icon">๐ฅ</span> ุงูุนููุงุก</a></li>
            <li><a href="suppliers.html"><span class="icon">๐ข</span> ุงูููุฑุฏูู</a></li>
            <li><a href="sales.html"><span class="icon">๐ฐ</span> ุงููุจูุนุงุช</a></li>
            <li><a href="delivery-notes.html"><span class="icon">๐</span> ุฃุฐูู ุงูุตุฑู</a></li>
            <li><a href="settlements.html"><span class="icon">โ</span> ุงูุชุณููุงุช</a></li>
            <li><a href="receipts.html"><span class="icon">๐ต</span> ุณูุฏุงุช ุงููุจุถ</a></li>
            <li><a href="payments.html"><span class="icon">๐ธ</span> ุณูุฏุงุช ุงูุตุฑู</a></li>
            <li><a href="purchases.html"><span class="icon">๐</span> ุงููุดุชุฑูุงุช</a></li>
            <li><a href="inventory.html" class="active"><span class="icon">๐</span> ุฅุฏุงุฑุฉ ุงูุฌุฑุฏ ูุงููุฑุชุฌุนุงุช</a></li>
            <li><a href="assets.html"><span class="icon">๐๏ธ</span> ุฃุตูู ุงูุดุฑูุฉ</a></li>
            <li><a href="reports.html"><span class="icon">๐</span> ุญุณุงุจ ุงูุฃุฑุจุงุญ</a></li>
            <li><a href="expenses.html"><span class="icon">๐ผ</span> ุงููุตุงุฑูู ุงูุชุดุบูููุฉ</a></li>
            <li><a href="backup.html"><span class="icon">๐พ</span> ุงููุณุฎ ุงูุงุญุชูุงุทู</a></li>
            <li><a href="action-logs.html"><span class="icon">๐</span> ุณุฌู ุงูุญุฑูุงุช</a></li>
            <li><a href="users.html"><span class="icon">๐ค</span> ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู ูุงูุตูุงุญูุงุช</a></li>
            <li><a href="settings.html"><span class="icon">โ๏ธ</span> ุงูุฅุนุฏุงุฏุงุช</a></li>
            <li><a href="about.html"><span class="icon">๐ง</span> ุนู ุงูุดุฑูุฉ</a></li>
            <li class="logout-item">
                <button class="logout-btn" title="ุชุณุฌูู ุงูุฎุฑูุฌ">
                    <img src="assets/logout-16.ico" alt="ุชุณุฌูู ุงูุฎุฑูุฌ" class="icon">
                    <span>ุชุณุฌูู ุงูุฎุฑูุฌ</span>
                </button>
            </li>
        </ul>
        <div class="sidebar-footer">
            <p class="copyright-text">ยฉ 2025 ูุธุงู ุฃุณูู โ ุชู ุงูุชุทููุฑ ุจูุงุณุทุฉ ุงููููุฏุณ ูุญูุฏ ูุญุณู. ุฌููุน ุงูุญููู ูุญููุธุฉ.</p>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="content-header">
            <h1>ุฅุฏุงุฑุฉ ุงูุฌุฑุฏ ูุงููุฑุชุฌุนุงุช</h1>
            <div style="display: flex; gap: 10px;">
                <button class="btn btn-secondary" id="refreshBtn" title="ุชุญุฏูุซ ุงูุจูุงูุงุช">
                    <span>๐</span> ุชุญุฏูุซ
                </button>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs-container" style="margin-bottom: 20px;">
            <div class="tabs">
                <button class="tab-btn active" data-tab="adjustment" id="adjustmentTabBtn">ุฌุฑุฏ</button>
                <button class="tab-btn" data-tab="return" id="returnTabBtn">ูุฑุชุฌุน</button>
            </div>
        </div>

        <!-- Tab 1: Inventory Adjustments -->
        <div class="tab-content active" id="adjustment-tab">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="margin: 0;">ุนูููุงุช ุงูุฌุฑุฏ</h2>
                <button class="btn btn-primary" id="newAdjustmentBtn">
                    <span>+</span> ุนูููุฉ ุฌุฑุฏ ุฌุฏูุฏุฉ
                </button>
            </div>

            <!-- Filters and Search -->
            <div class="filters-section">
                <div class="search-box">
                    <input type="text" id="adjustmentSearchInput" placeholder="ุจุญุซ ูู ุงูููุชุฌุงุช...">
                    <span class="search-icon">๐</span>
                </div>
                <div class="filter-group">
                    <select id="adjustmentCategoryFilter">
                        <option value="">ุฌููุน ุงูุฃุตูุงู</option>
                    </select>
                    <select id="adjustmentStatusFilter">
                        <option value="">ุฌููุน ุงูุญุงูุงุช</option>
                        <option value="active">ูุดุท</option>
                        <option value="inactive">ุบูุฑ ูุดุท</option>
                    </select>
                </div>
            </div>

            <!-- Inventory Adjustments Table -->
            <div class="table-container">
                <table class="inventory-table">
                    <thead>
                        <tr>
                            <th>ุฑูู ุงูุนูููุฉ</th>
                            <th>ุงูุชุงุฑูุฎ</th>
                            <th>ุงูููุชุฌ</th>
                            <th>ุงููุฎุฒูู ูุจู</th>
                            <th>ููุน ุงูุชุนุฏูู</th>
                            <th>ุงููููุฉ</th>
                            <th>ุงููุฎุฒูู ุจุนุฏ</th>
                            <th>ุงูุณุจุจ</th>
                            <th>ุงูุฅุฌุฑุงุกุงุช</th>
                        </tr>
                    </thead>
                    <tbody id="adjustmentTableBody">
                        <!-- Inventory adjustments will be loaded here -->
                    </tbody>
                </table>
                <div class="empty-state hidden" id="adjustmentEmptyState">
                    <p>ูุง ุชูุฌุฏ ุนูููุงุช ุฌุฑุฏ</p>
                    <button class="btn btn-primary" id="adjustmentEmptyStateAddBtn">
                        ุนูููุฉ ุฌุฑุฏ ุฌุฏูุฏุฉ
                    </button>
                </div>
            </div>

            <!-- Pagination -->
            <div class="pagination-container hidden" id="adjustmentPaginationContainer">
                <div class="pagination-info">
                    <span id="adjustmentPaginationInfo">ุนุฑุถ 0 - 0 ูู 0</span>
                </div>
                <div class="pagination-controls">
                    <button type="button" id="adjustmentPrevPageBtn" class="btn btn-secondary" disabled>โ ุงูุณุงุจู</button>
                    <span class="page-numbers" id="adjustmentPageNumbers"></span>
                    <button type="button" id="adjustmentNextPageBtn" class="btn btn-secondary" disabled>ุงูุชุงูู โ</button>
                </div>
            </div>
        </div>

        <!-- Tab 2: Returns -->
        <div class="tab-content" id="return-tab">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="margin: 0;">ุนูููุงุช ุงููุฑุชุฌุน</h2>
                <button class="btn btn-primary" id="newReturnBtn">
                    <span>+</span> ุนูููุฉ ูุฑุชุฌุน ุฌุฏูุฏุฉ
                </button>
            </div>

            <!-- Filters and Search -->
            <div class="filters-section">
                <div class="search-box">
                    <input type="text" id="returnSearchInput" placeholder="ุจุญุซ ูู ุงูููุชุฌุงุช...">
                    <span class="search-icon">๐</span>
                </div>
                <div class="filter-group">
                    <select id="returnCategoryFilter">
                        <option value="">ุฌููุน ุงูุฃุตูุงู</option>
                    </select>
                    <select id="returnStatusFilter">
                        <option value="">ุฌููุน ุงูุญุงูุงุช</option>
                        <option value="active">ูุดุท</option>
                        <option value="inactive">ุบูุฑ ูุดุท</option>
                    </select>
                </div>
            </div>

            <!-- Returns Table -->
            <div class="table-container">
                <table class="inventory-table">
                    <thead>
                        <tr>
                            <th>ุฑูู ุงููุฑุชุฌุน</th>
                            <th>ุงูุชุงุฑูุฎ</th>
                            <th>ููุน ุงููุฑุชุฌุน</th>
                            <th>ุงูููุชุฌ</th>
                            <th>ุงููููุฉ</th>
                            <th>ุณุนุฑ ุงููุญุฏุฉ</th>
                            <th>ุงููุจูุบ ุงูุฅุฌูุงูู</th>
                            <th>ุณุจุจ ุงููุฑุชุฌุน</th>
                            <th>ุงูุฅุฌุฑุงุกุงุช</th>
                        </tr>
                    </thead>
                    <tbody id="returnTableBody">
                        <!-- Returns will be loaded here -->
                    </tbody>
                </table>
                <div class="empty-state hidden" id="returnEmptyState">
                    <p>ูุง ุชูุฌุฏ ุนูููุงุช ูุฑุชุฌุน</p>
                    <button class="btn btn-primary" id="returnEmptyStateAddBtn">
                        ุนูููุฉ ูุฑุชุฌุน ุฌุฏูุฏุฉ
                    </button>
                </div>
            </div>

            <!-- Pagination -->
            <div class="pagination-container hidden" id="returnPaginationContainer">
                <div class="pagination-info">
                    <span id="returnPaginationInfo">ุนุฑุถ 0 - 0 ูู 0</span>
                </div>
                <div class="pagination-controls">
                    <button type="button" id="returnPrevPageBtn" class="btn btn-secondary" disabled>โ ุงูุณุงุจู</button>
                    <span class="page-numbers" id="returnPageNumbers"></span>
                    <button type="button" id="returnNextPageBtn" class="btn btn-secondary" disabled>ุงูุชุงูู โ</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Adjustment Modal (for Inventory Adjustments) -->
    <div class="modal" id="adjustmentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="adjustmentModalTitle">ุนูููุฉ ุฌุฑุฏ ุฌุฏูุฏุฉ</h2>
                <button class="modal-close" id="closeAdjustmentModal">&times;</button>
            </div>
            <form id="adjustmentForm" class="inventory-form">
                <input type="hidden" id="adjustmentId" name="adjustmentId">
                <input type="hidden" id="adjustmentIsEdit" name="adjustmentIsEdit" value="false">

                <div class="form-row">
                    <div class="form-group">
                        <label for="adjustmentDate">ุงูุชุงุฑูุฎ <span class="required">*</span></label>
                        <input type="date" id="adjustmentDate" name="adjustmentDate" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="adjustmentProductSelect">ุงุฎุชุฑ ุงูููุชุฌ <span class="required">*</span></label>
                        <select id="adjustmentProductSelect" name="adjustmentProductSelect" required>
                            <option value="">ุงุฎุชุฑ ุงูููุชุฌ</option>
                        </select>
                    </div>
                </div>

                <div id="adjustmentProductInfo" class="product-info hidden">
                    <div class="info-item">
                        <span class="info-label">ุงููุฎุฒูู ุงูุญุงูู:</span>
                        <span class="info-value" id="adjustmentCurrentStock">0</span>
                        <span id="adjustmentProductUnit"></span>
                    </div>
                </div>

                <div class="form-row" id="adjustmentTypeRow">
                    <div class="form-group">
                        <label for="adjustmentType">ููุน ุงูุชุนุฏูู <span class="required">*</span></label>
                        <select id="adjustmentType" name="adjustmentType">
                            <option value="increase">ุฒูุงุฏุฉ</option>
                            <option value="decrease">ููุตุงู</option>
                            <option value="set">ุชุญุฏูุฏ ูููุฉ ูุนููุฉ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="adjustmentAmount">ุงููููุฉ <span class="required">*</span></label>
                        <input type="number" id="adjustmentAmount" name="adjustmentAmount" 
                               min="0" step="0.01" required>
                        <small id="adjustmentAmountHint">ูููุฉ ุงูุฒูุงุฏุฉ ุฃู ุงูููุตุงู</small>
                    </div>
                </div>

                <div class="form-row" id="adjustmentNewStockRow" style="display: none;">
                    <div class="form-group full-width">
                        <label for="adjustmentNewStock">ุงููุฎุฒูู ุงูุฌุฏูุฏ</label>
                        <input type="number" id="adjustmentNewStock" name="adjustmentNewStock" 
                               min="0" step="0.01" readonly style="background: #f5f5f5;">
                        <small>ุณูุชู ุชุญุฏูุซู ุชููุงุฆูุงู</small>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group full-width">
                        <label for="adjustmentReason">ุณุจุจ ุงูุชุนุฏูู <span class="required">*</span></label>
                        <input type="text" id="adjustmentReason" name="adjustmentReason" 
                               placeholder="ูุซุงู: ุฌุฑุฏ ุฏูุฑูุ ุชุงูู..." required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group full-width">
                        <label for="adjustmentNotes">ููุงุญุธุงุช</label>
                        <textarea id="adjustmentNotes" name="adjustmentNotes" rows="3" placeholder="ุฃู ููุงุญุธุงุช ุฅุถุงููุฉ"></textarea>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelAdjustmentBtn">ุฅูุบุงุก</button>
                    <button type="submit" class="btn btn-primary">ุญูุธ ุงูุนูููุฉ</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Return Modal (for Returns) -->
    <div class="modal" id="returnModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="returnModalTitle">ุนูููุฉ ูุฑุชุฌุน ุฌุฏูุฏุฉ</h2>
                <button class="modal-close" id="closeReturnModal">&times;</button>
            </div>
            <form id="returnForm" class="inventory-form">
                <input type="hidden" id="returnId" name="returnId">
                <input type="hidden" id="returnIsEdit" name="returnIsEdit" value="false">

                <div class="form-row">
                    <div class="form-group">
                        <label for="returnDate">ุงูุชุงุฑูุฎ <span class="required">*</span></label>
                        <input type="date" id="returnDate" name="returnDate" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="returnType">ููุน ุงููุฑุชุฌุน <span class="required">*</span></label>
                        <select id="returnType" name="returnType" required>
                            <option value="">ุงุฎุชุฑ ููุน ุงููุฑุชุฌุน</option>
                            <option value="from_customer">ูุฑุชุฌุน ูู ุนููู</option>
                            <option value="to_supplier">ูุฑุชุฌุน ุฅูู ููุฑุฏ</option>
                        </select>
                    </div>
                    <div class="form-group" id="returnEntitySelectGroup" style="display: none;">
                        <label id="returnEntityLabel">ุงุฎุชุฑ <span class="required">*</span></label>
                        <select id="returnEntitySelect" name="returnEntitySelect">
                            <option value="">ุงุฎุชุฑ</option>
                        </select>
                    </div>
                </div>

                <div class="form-row" id="restoreBalanceRow" style="display: none;">
                    <div class="form-group full-width">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="restoreBalance" name="restoreBalance" style="width: 20px; height: 20px; cursor: pointer;">
                            <span id="restoreBalanceLabel">ุงุณุชุนุงุฏุฉ ุงูุฑุตูุฏ ูู ุญุณุงุจ ุงูุนููู</span>
                        </label>
                        <small id="restoreBalanceHint">ุฅุฐุง ุชู ุชุญุฏูุฏ ูุฐุง ุงูุฎูุงุฑุ ุณูุชู ุฎุตู ูููุฉ ุงููุฑุชุฌุน ูู ุฑุตูุฏ ุงูุนููู</small>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="returnProductSelect">ุงุฎุชุฑ ุงูููุชุฌ <span class="required">*</span></label>
                        <select id="returnProductSelect" name="returnProductSelect" required>
                            <option value="">ุงุฎุชุฑ ุงูููุชุฌ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="returnUnit">ุงููุญุฏุฉ</label>
                        <input type="text" id="returnUnit" name="returnUnit" readonly style="background: #f5f5f5;">
                        <small>ูุญุฏุฉ ููุงุณ ุงูููุชุฌ</small>
                    </div>
                </div>

                <div class="form-row" id="returnQuantityRow">
                    <div class="form-group">
                        <label for="returnQuantity">ุงููููุฉ ุงููุฑุชุฌุนุฉ <span class="required">*</span></label>
                        <input type="number" id="returnQuantity" name="returnQuantity" 
                               min="0" step="0.01" placeholder="0.00" required>
                    </div>
                    <div class="form-group">
                        <label for="returnUnitPrice">ุณุนุฑ ุงููุญุฏุฉ <span class="required">*</span></label>
                        <input type="number" id="returnUnitPrice" name="returnUnitPrice" 
                               min="0" step="0.01" placeholder="0.00" required>
                        <small>ูุชู ุงุณุชุฎุฏุงูู ูุญุณุงุจ ูููุฉ ุงููุฑุชุฌุน</small>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group full-width">
                        <label for="returnReason">ุณุจุจ ุงููุฑุชุฌุน <span class="required">*</span></label>
                        <select id="returnReason" name="returnReason" required>
                            <option value="">ุงุฎุชุฑ ุณุจุจ ุงููุฑุชุฌุน</option>
                            <option value="damaged">ุชุงูู</option>
                            <option value="defective">ูุนูุจ</option>
                            <option value="wrong_item">ุตูู ุฎุงุทุฆ</option>
                            <option value="expired">ููุชูู ุงูุตูุงุญูุฉ</option>
                            <option value="customer_request">ุทูุจ ุงูุนููู</option>
                            <option value="other">ุฃุฎุฑู</option>
                        </select>
                        <small id="returnReasonHint">ุฅุฐุง ูุงู ุงูุณุจุจ "ุชุงูู" ุฃู "ููุชูู ุงูุตูุงุญูุฉ" ูู ูุชู ุฅุนุงุฏุฉ ุงููููุฉ ูููุฎุฒูู</small>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group full-width">
                        <label for="returnNotes">ููุงุญุธุงุช</label>
                        <textarea id="returnNotes" name="returnNotes" rows="3" placeholder="ุฃู ููุงุญุธุงุช ุฅุถุงููุฉ"></textarea>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelReturnBtn">ุฅูุบุงุก</button>
                    <button type="submit" class="btn btn-primary">ุญูุธ ุงููุฑุชุฌุน</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Notification Container -->
    <div id="toastContainer" class="toast-container"></div>

    <script src="scripts/permissions.js"></script>
    <script src="scripts/toast.js"></script>
    <script src="scripts/sidebar.js"></script>
    <script src="scripts/logout.js"></script>
    <script src="scripts/inventory.js"></script>
</body>
</html>

